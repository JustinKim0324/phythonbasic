<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- GitHub Pages 프로젝트 페이지 기준 경로 고정 -->
  <base href="/phythonbasic/">
  <title>강의 보기</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; line-height: 1.6; margin: 24px; color:#222; }
    .container { max-width: 860px; margin: 0 auto; }
    .topbar { display:flex; align-items:center; gap:12px; margin-bottom:16px; }
    .topbar a { text-decoration:none; color:#2563eb; }
    .status { font-size:14px; color:#666; }
    pre, code { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    pre { background:#f6f8fa; padding:12px; overflow:auto; border-radius:8px; }
    img { max-width:100%; height:auto; }
    blockquote { border-left:4px solid #e5e7eb; margin: 0; padding: 0 12px; color:#555; }
  </style>
  <!-- Markdown 렌더러 (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <a href="index.html">← 목록으로</a>
      <span class="status" id="status">강의 내용을 불러오는 중…</span>
    </div>
    <article id="content"> </article>
  </div>

  <script>
    (function () {
      const params = new URLSearchParams(location.search);
      // 기본 파일명은 필요에 맞게 바꾸세요.
      const rawFile = params.get('file') || 'lessons1.md';

      // 보안 및 오타 방지: 단순한 파일명(.md)만 허용
      const isSafe = /^[a-zA-Z0-9._-]+\.md$/.test(rawFile);
      const file = isSafe ? rawFile : 'lessons1.md';

      const statusEl = document.getElementById('status');
      const contentEl = document.getElementById('content');

      // 상대경로로 fetch → /phythonbasic/<file> 에서 가져옴
      fetch(file, { cache: 'no-store' })
        .then(res => {
          if (!res.ok) throw new Error(`(${res.status}) ${res.statusText}`);
          return res.text();
        })
        .then(md => {
          // marked 기본 옵션(필요 시 확장)
          if (window.marked) {
            // GitHub 스타일 코드블록 언어 지정이 없어도 렌더는 됩니다.
            contentEl.innerHTML = marked.parse(md);
          } else {
            // 혹시 CDN이 실패했을 때 대비
            contentEl.textContent = md;
          }
          statusEl.textContent = file + ' 로딩 완료';
        })
        .catch(err => {
          statusEl.textContent = '로딩 실패';
          contentEl.innerHTML = `
            <p>파일을 불러오지 못했습니다: <code>${file}</code></p>
            <pre>${String(err)}</pre>
            <p>확인하세요:</p>
            <ul>
              <li><code>${file}</code>이 저장소의 <strong>같은 폴더</strong>에 있는지</li>
              <li>파일명(대/소문자 포함)이 링크와 정확히 일치하는지</li>
            </ul>`;
        });
    })();
  </script>
</body>
</html>
